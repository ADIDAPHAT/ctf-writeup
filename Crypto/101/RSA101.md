# RSA101

## THE MATHEMATICS
* Modulo P
```
Zp = {0,1,2,...,p−1}

Example:
Z5 = {0,1,2,3,4}

```
* Greatest Common Divisor (gcd)
```
The greatest common divisor (gcd) between two numbers is the largest integer that will divide both numbers. 

Example:
gcd(12,30) = 6
```
* Multiplicative Inverse
```
If two numbers have a gcd of 1, then the smaller of the two numbers has a multiplicative inverse in the modulo of the larger number

Example:
For mod 9 {0,1,2,3,4,5,6,7,8}
gcd(4,9) = 1, so 4 has a multiplicative inverse in the mod 9
Written: 4^(-1) in mod 9
4^(-1) in mod 9 is 7
4 X 7 = 28 = 1 mod 9
```
* Prime Numbers
```
A prime is a number that can only be divided without a remainder by itself and 1.

Example:
2, 3, 5, 7, 11, 13, 17, 19, ...
```
* Euler's totient function
```
Euler's totient function counts the positive integers up to a given integer n that are relatively prime to n

Example:
the totatives of n = 9 are the six numbers 1, 2, 4, 5, 7 and 8.
ϕ(9) = 1, 2, 4, 5, 7 and 8.
```
* Key Generation
```
1) Large Prime Number Generation: Two large prime numbers p and q
need to be generated. These numbers are very large: At least 512 digits, but 1024 digits is considered safe.
2) Modulus: From the two large numbers, a modulus n
is generated by multiplying p and q.
3) Totient: The totient of n,ϕ(n)is calculated.
4) Public Key: A prime number is calculated from the range [3,ϕ(n)) that has a greatest common divisor of 1 with ϕ(n).
5) Private Key: Because the prime in step 4 has a gcd of 1 with ϕ(n) , we are able to determine it's inverse with respect to modϕ(n)

After the five steps above, we will have our keys. Lets go over each step.
```

## Final Example: RSA From Scratch
This is the part that everyone has been waiting for: an example of RSA from the ground up. I am first going to give an academic example, and then a real world example.

### Calculation of Modulus And Totient
```
Lets choose two primes: p=11 and q=13. Hence the modulus is n=p×q=143. 
The totient of n ϕ(n)=(p−1)⋅(q−1)=120.
```
### Key Generation
```
For the public key, a random prime number that has a greatest common divisor (gcd) of 1 with ϕ(n) and is less than ϕ(n) is chosen. 
Let's choose 7 (note: both 3 and 5 do not have a gcd of 1 with ϕ(n). So e = 7, and to determine d, the secret key, 
we need to find the inverse of 7 with ϕ(n). This can be done very easily and quickly with the Extended Euclidean Algorithm, 
and hence d = 103. This can be easily verified: e⋅d = 1 modϕ(n) and 7⋅103 = 721 = 1 mod 120.
```
### Encryption/Decryption
```
Lets choose our plaintext message, m to be 9:
```
### Encryption:
```
m^e mod n = 97 mod 143 = 48
c = 48
```
### Decryption:
```
c^d mod n = 48^103 mod 143 = 9 = m
m = 9
```

### The example of RSA calculation
```
Select p: p is a prime (large)
p = 3

Select q: q is a prime (large)
q = 11

Compute n: n = p X q
n = 3 X 11

Check z: z = (p-1) X (q-1) # This is the totient ϕ(n). There are 20 relative primes to 33 (1,2,4,5,7,8,10,13,14,16,17,19,20.23,25,26,28,29,31,32)

Select d: gcd(totein(n),d) = 1; 1 < d < totient ϕ(n). 
d = 7 (7 and 20 have no common factors but 1)

Compute e: e = pow(d, -1) mod totient ϕ(n)
e = (1/7) mod 20.
e = 3. (round up)

Public key: KU = {e, n}
Private key: KR = {d, n}

Public key: KU = {3, 33}
Private key: KR = {7, 33}

for messege m = 5.
To encrypt: C = pow(M, e) mod n
C = pow(5, 3) mod 33
C = 26
To decrypt: M = pow(C, d) mod n
M = pow(26, 7) mod 33
M = 5

```

## A Real World Example
```
p = 12131072439211271897323671531612440428472427633701410925634549312301964373042085619324197365322416866541017057361365214171711713797974299334871062829803541

q = 12027524255478748885956220793734512128733387803682075433653899983955179850988797899869146900809131611153346817050832096022160146366346391812470987105415233

n = p X q 
n = 145906768007583323230186939349070635292401872375357164399581871019873438799005358938369571402670149802121818086292467422828157022922076746906543401224889672472407926969987100581290103199317858753663710862357656510507883714297115637342788911463535102712032765166518411726859837988672111837205085526346618740053

ϕ(n) = 145906768007583323230186939349070635292401872375357164399581871019873438799005358938369571402670149802121818086292467422828157022922076746906543401224889648313811232279966317301397777852365301547848273478871297222058587457152891606459269718119268971163555070802643999529549644116811947516513938184296683521280

e - the public key
65537 has a gcd of 1 with ϕ(n), so lets use it as the public key. To calculate the private key, use extended euclidean algorithm to find the multiplicative inverse with respect to ϕ(n).

d = 89489425009274444368228545921773093919669586065884257445497854456487674839629818390934941973262879616797970608917283679875499331574161113854088813275488110588247193077582527278437906504015680623423550067240042466665654232383502922215493623289472138866445818789127946123407807725702626644091036502372545139713

Encryption: 1976620216402300889624482718775150^e mod n

CIPHER: 35052111338673026690212423937053328511880760811579981620642802346685810623109850235943049080973386241113784040794704193978215378499765413083646438784740952306932534945195080183861574225226218879827232453912820596886440377536082465681750074417459151485407445862511023472235560823053497791518928820272257787786 

Decryption: 35052111338673026690212423937053328511880760811579981620642802346685810623109850235943049080973386241113784040794704193978215378499765413083646438784740952306932534945195080183861574225226218879827232453912820596886440377536082465681750074417459151485407445862511023472235560823053497791518928820272257787786^d mod n

1976620216402300889624482718775150 ("attack at dawn") 

```

Credit: 
* [http://doctrina.org/How-RSA-Works-With-Examples.html](http://doctrina.org/How-RSA-Works-With-Examples.html)
* [https://en.wikipedia.org/wiki/Euler%27s_totient_function](https://en.wikipedia.org/wiki/Euler%27s_totient_function)