# RSA101

## THE MATHEMATICS
* Modulo P
```
Zp = {0,1,2,...,p−1}

Example:
Z5 = {0,1,2,3,4}

```
* Greatest Common Divisor (gcd)
```
The greatest common divisor (gcd) between two numbers is the largest integer that will divide both numbers. 

Example:
gcd(12,30) = 6
```
* Multiplicative Inverse
```
If two numbers have a gcd of 1, then the smaller of the two numbers has a multiplicative inverse in the modulo of the larger number

Example:
For mod 9 {0,1,2,3,4,5,6,7,8}
gcd(4,9) = 1, so 4 has a multiplicative inverse in the mod 9
Written: 4^(-1) in mod 9
4^(-1) in mod 9 is 7
4 X 7 = 28 = 1 mod 9
```
* Prime Numbers
```
A prime is a number that can only be divided without a remainder by itself and 1.

Example:
2, 3, 5, 7, 11, 13, 17, 19, ...
```
* Euler's totient function
```
Euler's totient function counts the positive integers up to a given integer n that are relatively prime to n

Example:
the totatives of n = 9 are the six numbers 1, 2, 4, 5, 7 and 8.
ϕ(9) = 1, 2, 4, 5, 7 and 8.
```
* Key Generation
```
1) Large Prime Number Generation: Two large prime numbers p and q
need to be generated. These numbers are very large: At least 512 digits, but 1024 digits is considered safe.
2) Modulus: From the two large numbers, a modulus n
is generated by multiplying p and q.
3) Totient: The totient of n,ϕ(n)is calculated.
4) Public Key: A prime number is calculated from the range [3,ϕ(n)) that has a greatest common divisor of 1 with ϕ(n).
5) Private Key: Because the prime in step 4 has a gcd of 1 with ϕ(n) , we are able to determine it's inverse with respect to modϕ(n)

After the five steps above, we will have our keys. Lets go over each step.
```


### The example of RSA calculation
```
Select p: p is a prime (large)
p = 3

Select q: q is a prime (large)
q = 11

Compute n: n = p X q
n = 3 X 11

Check z: z = (p-1) X (q-1) # This is the totient ϕ(n). There are 20 relative primes to 33 (1,2,4,5,7,8,10,13,14,16,17,19,20.23,25,26,28,29,31,32)

Select d: gcd(totein(n),d) = 1; 1 < d < totient ϕ(n). 
d = 7 (7 and 20 have no common factors but 1)

Compute e: e = pow(d, -1) mod totient ϕ(n)
e = (1/7) mod 20.
e = 3. (round up)

Public key: KU = {e, n}
Private key: KR = {d, n}

Public key: KU = {3, 33}
Private key: KR = {7, 33}

for messege m = 5.
To encrypt: C = pow(M, e) mod n
C = pow(5, 3) mod 33
C = 26
To decrypt: M = pow(C, d) mod n
M = pow(26, 7) mod 33
M = 5

```

Credit: 
* [http://doctrina.org/How-RSA-Works-With-Examples.html](http://doctrina.org/How-RSA-Works-With-Examples.html)
* [https://en.wikipedia.org/wiki/Euler%27s_totient_function](https://en.wikipedia.org/wiki/Euler%27s_totient_function)